You can use the `Application.ActiveWorkbook.Path` property to return the local path of the currently open workbook. This should work even if the file is synced with OneDrive/SharePoint. You can then use this path to create folders and save files locally.